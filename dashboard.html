<!-- ========================================================================= -->
<!-- === DASHBOARD INTEGRADO COM CARDÁPIO ONLINE ============================ -->
<!-- ========================================================================= -->
<div id="dashboard" class="content active">
    <div class="dashboard-header">
        <h2><i class="fas fa-tachometer-alt"></i> Dashboard Integrado</h2>
        <div class="header-controls">
            <select id="periodFilter" class="form-control" onchange="updateDashboard()">
                <option value="7">Últimos 7 dias</option>
                <option value="30" selected>Últimos 30 dias</option>
                <option value="90">Últimos 3 meses</option>
            </select>
            <button class="btn btn-primary" onclick="syncWithMenu()">
                <i class="fas fa-sync-alt"></i> Sincronizar Cardápio
            </button>
        </div>
    </div>

    <!-- Cards Principais Integrados -->
    <div class="card-grid">
        <!-- Vendas Online -->
        <div class="card success">
            <div class="card-icon">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="card-content">
                <div class="card-title">Vendas Online</div>
                <div class="card-value" id="cardVendasOnline">R$ 0,00</div>
                <div class="card-subtitle" id="pedidosOnline">0 pedidos</div>
                <div class="card-trend positive">
                    <i class="fas fa-arrow-up"></i>
                    <span id="vendasOnlineTrend">0%</span>
                </div>
            </div>
        </div>
        
        <!-- Vendas Presenciais -->
        <div class="card info">
            <div class="card-icon">
                <i class="fas fa-store"></i>
            </div>
            <div class="card-content">
                <div class="card-title">Vendas Presenciais</div>
                <div class="card-value" id="cardVendasPresenciais">R$ 0,00</div>
                <div class="card-subtitle" id="pedidosPresenciais">0 pedidos</div>
                <div class="card-trend positive">
                    <i class="fas fa-arrow-up"></i>
                    <span id="vendasPresenciaisTrend">0%</span>
                </div>
            </div>
        </div>
        
        <!-- Produtos Mais Vendidos -->
        <div class="card warning">
            <div class="card-icon">
                <i class="fas fa-star"></i>
            </div>
            <div class="card-content">
                <div class="card-title">Produto Mais Vendido</div>
                <div class="card-value" id="topProductName">-</div>
                <div class="card-subtitle" id="topProductSales">0 vendas</div>
            </div>
        </div>
        
        <!-- Ticket Médio -->
        <div class="card primary">
            <div class="card-icon">
                <i class="fas fa-receipt"></i>
            </div>
            <div class="card-content">
                <div class="card-title">Ticket Médio</div>
                <div class="card-value" id="cardTicketMedio">R$ 0,00</div>
                <div class="card-subtitle" id="ticketComparacao">vs R$ 0,00</div>
            </div>
        </div>
    </div>

    <!-- Status do Cardápio Online -->
    <div class="card-grid secondary">
        <div class="card success">
            <div class="card-content">
                <div class="card-title">Cardápio Online</div>
                <div class="card-value" id="cardStatusCardapio">Ativo</div>
                <div class="card-subtitle" id="cardProdutosAtivos">0 produtos</div>
                <div class="card-actions">
                    <button class="btn btn-sm btn-success" onclick="openMenuManager()">
                        <i class="fas fa-cog"></i> Gerenciar
                    </button>
                </div>
            </div>
        </div>
        
        <div class="card info">
            <div class="card-content">
                <div class="card-title">Pedidos Pendentes</div>
                <div class="card-value" id="cardPedidosPendentes">0</div>
                <div class="card-subtitle" id="cardTempoMedio">Tempo médio: 0min</div>
                <div class="card-actions">
                    <button class="btn btn-sm btn-warning" onclick="viewPendingOrders()">
                        <i class="fas fa-list"></i> Ver Pedidos
                    </button>
                </div>
            </div>
        </div>
        
        <div class="card warning">
            <div class="card-content">
                <div class="card-title">Avaliações</div>
                <div class="card-value" id="cardAvaliacaoMedia">0.0</div>
                <div class="card-subtitle" id="cardTotalAvaliacoes">0 avaliações</div>
                <div class="card-actions">
                    <button class="btn btn-sm btn-info" onclick="viewReviews()">
                        <i class="fas fa-comments"></i> Ver Avaliações
                    </button>
                </div>
            </div>
        </div>
        
        <div class="card danger">
            <div class="card-content">
                <div class="card-title">Itens sem Estoque</div>
                <div class="card-value" id="cardItensSemEstoque">0</div>
                <div class="card-subtitle" id="cardItensCriticos">0 críticos</div>
                <div class="card-actions">
                    <button class="btn btn-sm btn-danger" onclick="viewLowStock()">
                        <i class="fas fa-box"></i> Repor Estoque
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Gráficos Integrados -->
    <div class="charts-container">
        <div class="chart-row">
            <div class="chart-card">
                <h3>Vendas Online vs Presencial</h3>
                <canvas id="salesComparisonChart" style="max-height: 300px;"></canvas>
            </div>
            
            <div class="chart-card">
                <h3>Top 5 Produtos Mais Vendidos</h3>
                <canvas id="topProductsChart" style="max-height: 300px;"></canvas>
            </div>
        </div>
        
        <div class="chart-row">
            <div class="chart-card">
                <h3>Horários de Pico</h3>
                <canvas id="peakHoursChart" style="max-height: 300px;"></canvas>
            </div>
            
            <div class="chart-card">
                <h3>Status dos Pedidos</h3>
                <div class="orders-status">
                    <div class="status-item">
                        <span class="status-dot pending"></span>
                        <span class="status-label">Pendentes:</span>
                        <span class="status-value" id="statusPendentes">0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot preparing"></span>
                        <span class="status-label">Preparando:</span>
                        <span class="status-value" id="statusPreparando">0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot ready"></span>
                        <span class="status-label">Prontos:</span>
                        <span class="status-value" id="statusProntos">0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot delivered"></span>
                        <span class="status-label">Entregues:</span>
                        <span class="status-value" id="statusEntregues">0</span>
                    </div>
                </div>
                
                <div class="delivery-stats">
                    <h4>Estatísticas de Entrega</h4>
                    <div class="stat-item">
                        <span>Tempo Médio de Entrega:</span>
                        <span id="tempoMedioEntrega">0min</span>
                    </div>
                    <div class="stat-item">
                        <span>Taxa de Entrega:</span>
                        <span id="taxaEntrega">0%</span>
                    </div>
                    <div class="stat-item">
                        <span>Avaliação Entregas:</span>
                        <span id="avaliacaoEntregas">0.0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pedidos Recentes -->
    <div class="recent-orders">
        <div class="section-header">
            <h3>Pedidos Recentes</h3>
            <button class="btn btn-primary btn-sm" onclick="viewAllOrders()">
                Ver Todos <i class="fas fa-arrow-right"></i>
            </button>
        </div>
        <div class="orders-table" id="recentOrdersTable">
            <!-- Pedidos serão carregados aqui -->
        </div>
    </div>

    <!-- Alertas do Cardápio -->
    <div class="alerts-container">
        <h3>Alertas do Cardápio Online</h3>
        <div class="alerts-list" id="menuAlertsList">
            <!-- Alertas específicos do cardápio -->
        </div>
    </div>
</div>

<style>
/* ========================================================================= */
/* === ESTILOS DO DASHBOARD INTEGRADO ====================================== */
/* ========================================================================= */

.dashboard-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    flex-wrap: wrap;
    gap: 15px;
}

.header-controls {
    display: flex;
    gap: 15px;
    align-items: center;
    flex-wrap: wrap;
}

.card-actions {
    margin-top: 10px;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 0.8em;
}

.orders-status {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 20px;
}

.status-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 12px;
    background: #f8f9fa;
    border-radius: var(--radius);
}

.status-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.status-dot.pending { background: var(--warning); }
.status-dot.preparing { background: var(--info); }
.status-dot.ready { background: var(--success); }
.status-dot.delivered { background: var(--primary); }

.status-label {
    flex: 1;
    font-weight: 500;
}

.status-value {
    font-weight: bold;
    color: var(--dark);
}

.delivery-stats {
    background: var(--light);
    padding: 15px;
    border-radius: var(--radius);
}

.delivery-stats h4 {
    margin-bottom: 15px;
    color: var(--primary);
    font-size: 1em;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    padding-bottom: 8px;
    border-bottom: 1px solid #dee2e6;
}

.stat-item:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
}

.recent-orders {
    margin-top: 30px;
    background: var(--light);
    padding: 20px;
    border-radius: var(--radius);
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.orders-table {
    background: white;
    border-radius: var(--radius);
    overflow: hidden;
}

.order-row {
    display: grid;
    grid-template-columns: 80px 1fr 100px 100px 120px 100px;
    gap: 15px;
    padding: 12px 15px;
    border-bottom: 1px solid #dee2e6;
    align-items: center;
}

.order-row:last-child {
    border-bottom: none;
}

.order-row.header {
    background: var(--primary);
    color: white;
    font-weight: bold;
}

.order-id {
    font-weight: bold;
    color: var(--primary);
}

.order-customer {
    display: flex;
    flex-direction: column;
}

.customer-name {
    font-weight: 500;
}

.customer-phone {
    font-size: 0.8em;
    color: #666;
}

.order-type {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8em;
    font-weight: bold;
    text-align: center;
}

.type-delivery { background: #e3f2fd; color: var(--info); }
.type-pickup { background: #e8f5e8; color: var(--success); }

.order-status {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8em;
    font-weight: bold;
    text-align: center;
}

.status-pending { background: #fff3cd; color: #856404; }
.status-preparing { background: #d1ecf1; color: #0c5460; }
.status-ready { background: #d4edda; color: #155724; }
.status-delivered { background: #e2e3e5; color: #383d41; }

/* Responsividade */
@media (max-width: 768px) {
    .header-controls {
        flex-direction: column;
        width: 100%;
    }
    
    .order-row {
        grid-template-columns: 1fr;
        gap: 8px;
        text-align: center;
    }
    
    .order-row.header {
        display: none;
    }
    
    .chart-row {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
// =========================================================================
// === INTEGRAÇÃO COM CARDÁPIO ONLINE ======================================
// =========================================================================

// Estado do cardápio online
let onlineMenuState = {
    products: [],
    orders: [],
    categories: [],
    settings: {
        isActive: true,
        deliveryFee: 5.00,
        minOrderValue: 15.00,
        preparationTime: 30
    },
    reviews: []
};

// Gráficos
let salesComparisonChart = null;
let topProductsChart = null;
let peakHoursChart = null;

function updateDashboard() {
    updateMenuCards();
    updateSalesCharts();
    updateRecentOrders();
    updateMenuAlerts();
    calculateBusinessMetrics();
}

function updateMenuCards() {
    // Calcular métricas do cardápio online
    const onlineOrders = onlineMenuState.orders.filter(order => 
        order.channel === 'online' && 
        new Date(order.date) >= getStartDate()
    );
    
    const presentialOrders = state.vendas.filter(venda => 
        new Date(venda.data) >= getStartDate()
    );
    
    const pendingOrders = onlineMenuState.orders.filter(order => 
        order.status === 'pending' || order.status === 'preparing'
    );
    
    const outOfStockProducts = state.produtos.filter(product => product.estoque === 0);
    const lowStockProducts = state.produtos.filter(product => product.estoque > 0 && product.estoque <= 5);
    
    // Atualizar cards principais
    document.getElementById('cardVendasOnline').textContent = 
        formatCurrency(onlineOrders.reduce((sum, order) => sum + order.total, 0));
    document.getElementById('pedidosOnline').textContent = 
        `${onlineOrders.length} pedido${onlineOrders.length !== 1 ? 's' : ''}`;
    
    document.getElementById('cardVendasPresenciais').textContent = 
        formatCurrency(presentialOrders.reduce((sum, venda) => sum + venda.total, 0));
    document.getElementById('pedidosPresenciais').textContent = 
        `${presentialOrders.length} pedido${presentialOrders.length !== 1 ? 's' : ''}`;
    
    document.getElementById('cardPedidosPendentes').textContent = pendingOrders.length;
    document.getElementById('cardTempoMedio').textContent = 
        `Tempo médio: ${onlineMenuState.settings.preparationTime}min`;
    
    document.getElementById('cardItensSemEstoque').textContent = outOfStockProducts.length;
    document.getElementById('cardItensCriticos').textContent = `${lowStockProducts.length} críticos`;
    
    // Status do cardápio
    document.getElementById('cardStatusCardapio').textContent = 
        onlineMenuState.settings.isActive ? 'Ativo' : 'Inativo';
    document.getElementById('cardStatusCardapio').style.color = 
        onlineMenuState.settings.isActive ? 'var(--success)' : 'var(--danger)';
    document.getElementById('cardProdutosAtivos').textContent = 
        `${state.produtos.length} produtos ativos`;
    
    // Avaliações
    const averageRating = onlineMenuState.reviews.length > 0 ? 
        onlineMenuState.reviews.reduce((sum, review) => sum + review.rating, 0) / onlineMenuState.reviews.length : 0;
    document.getElementById('cardAvaliacaoMedia').textContent = averageRating.toFixed(1);
    document.getElementById('cardTotalAvaliacoes').textContent = 
        `${onlineMenuState.reviews.length} avaliação${onlineMenuState.reviews.length !== 1 ? 'ões' : ''}`;
    
    // Produto mais vendido
    updateTopProduct();
}

function updateSalesCharts() {
    updateSalesComparisonChart();
    updateTopProductsChart();
    updatePeakHoursChart();
}

function updateSalesComparisonChart() {
    const ctx = document.getElementById('salesComparisonChart').getContext('2d');
    const period = parseInt(document.getElementById('periodFilter').value);
    
    // Dados simulados para comparação
    const labels = ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'];
    const onlineData = [120, 150, 180, 200, 250, 300, 280];
    const presentialData = [300, 280, 320, 350, 400, 450, 420];
    
    if (salesComparisonChart) salesComparisonChart.destroy();
    
    salesComparisonChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Online',
                    data: onlineData,
                    backgroundColor: 'rgba(52, 152, 219, 0.8)',
                    borderColor: 'rgba(52, 152, 219, 1)',
                    borderWidth: 1
                },
                {
                    label: 'Presencial',
                    data: presentialData,
                    backgroundColor: 'rgba(46, 204, 113, 0.8)',
                    borderColor: 'rgba(46, 204, 113, 1)',
                    borderWidth: 1
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: function(value) {
                            return formatCurrency(value);
                        }
                    }
                }
            }
        }
    });
}

function updateTopProductsChart() {
    const ctx = document.getElementById('topProductsChart').getContext('2d');
    
    // Obter produtos mais vendidos
    const productSales = {};
    onlineMenuState.orders.forEach(order => {
        order.items.forEach(item => {
            productSales[item.productId] = (productSales[item.productId] || 0) + item.quantity;
        });
    });
    
    const topProducts = Object.entries(productSales)
        .sort(([,a], [,b]) => b - a)
        .slice(0, 5)
        .map(([productId, sales]) => {
            const product = state.produtos.find(p => p.id == productId) || { nome: 'Produto ' + productId };
            return { name: product.nome, sales: sales };
        });
    
    if (topProductsChart) topProductsChart.destroy();
    
    topProductsChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: topProducts.map(p => p.name),
            datasets: [{
                data: topProducts.map(p => p.sales),
                backgroundColor: [
                    'rgba(255, 99, 132, 0.8)',
                    'rgba(54, 162, 235, 0.8)',
                    'rgba(255, 206, 86, 0.8)',
                    'rgba(75, 192, 192, 0.8)',
                    'rgba(153, 102, 255, 0.8)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom'
                }
            }
        }
    });
}

function updatePeakHoursChart() {
    const ctx = document.getElementById('peakHoursChart').getContext('2d');
    
    // Dados simulados de horários de pico
    const labels = ['08h', '10h', '12h', '14h', '16h', '18h', '20h', '22h'];
    const orderData = [5, 8, 25, 15, 10, 30, 20, 8];
    
    if (peakHoursChart) peakHoursChart.destroy();
    
    peakHoursChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                label: 'Pedidos por Hora',
                data: orderData,
                borderColor: 'rgba(155, 89, 182, 1)',
                backgroundColor: 'rgba(155, 89, 182, 0.1)',
                borderWidth: 2,
                fill: true,
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

function updateRecentOrders() {
    const table = document.getElementById('recentOrdersTable');
    const recentOrders = onlineMenuState.orders.slice(-5).reverse();
    
    let html = `
        <div class="order-row header">
            <div>Pedido</div>
            <div>Cliente</div>
            <div>Valor</div>
            <div>Tipo</div>
            <div>Status</div>
            <div>Horário</div>
        </div>
    `;
    
    recentOrders.forEach(order => {
        const orderTime = new Date(order.date).toLocaleTimeString('pt-BR', { 
            hour: '2-digit', 
            minute: '2-digit' 
        });
        
        html += `
            <div class="order-row">
                <div class="order-id">#${order.id}</div>
                <div class="order-customer">
                    <div class="customer-name">${order.customer.name}</div>
                    <div class="customer-phone">${order.customer.phone}</div>
                </div>
                <div class="order-value">${formatCurrency(order.total)}</div>
                <div class="order-type ${order.type === 'delivery' ? 'type-delivery' : 'type-pickup'}">
                    ${order.type === 'delivery' ? 'Entrega' : 'Retirada'}
                </div>
                <div class="order-status status-${order.status}">
                    ${getStatusText(order.status)}
                </div>
                <div class="order-time">${orderTime}</div>
            </div>
        `;
    });
    
    if (recentOrders.length === 0) {
        html = '<div class="order-row" style="text-align: center; padding: 20px;">Nenhum pedido recente</div>';
    }
    
    table.innerHTML = html;
    
    // Atualizar status dos pedidos
    updateOrderStatus();
}

function updateOrderStatus() {
    const statusCounts = {
        pending: onlineMenuState.orders.filter(o => o.status === 'pending').length,
        preparing: onlineMenuState.orders.filter(o => o.status === 'preparing').length,
        ready: onlineMenuState.orders.filter(o => o.status === 'ready').length,
        delivered: onlineMenuState.orders.filter(o => o.status === 'delivered').length
    };
    
    document.getElementById('statusPendentes').textContent = statusCounts.pending;
    document.getElementById('statusPreparando').textContent = statusCounts.preparing;
    document.getElementById('statusProntos').textContent = statusCounts.ready;
    document.getElementById('statusEntregues').textContent = statusCounts.delivered;
}

function updateTopProduct() {
    const productSales = {};
    
    // Contar vendas de produtos
    onlineMenuState.orders.forEach(order => {
        order.items.forEach(item => {
            productSales[item.productId] = (productSales[item.productId] || 0) + item.quantity;
        });
    });
    
    state.vendas.forEach(venda => {
        venda.itens.forEach(item => {
            productSales[item.produtoId] = (productSales[item.produtoId] || 0) + item.quantidade;
        });
    });
    
    // Encontrar produto mais vendido
    let topProduct = null;
    let maxSales = 0;
    
    Object.entries(productSales).forEach(([productId, sales]) => {
        if (sales > maxSales) {
            const product = state.produtos.find(p => p.id == productId);
            if (product) {
                topProduct = product;
                maxSales = sales;
            }
        }
    });
    
    if (topProduct) {
        document.getElementById('topProductName').textContent = topProduct.nome;
        document.getElementById('topProductSales').textContent = `${maxSales} venda${maxSales !== 1 ? 's' : ''}`;
    }
}

function updateMenuAlerts() {
    const alertsList = document.getElementById('menuAlertsList');
    let alertsHTML = '';
    
    // Verificar produtos sem estoque
    const outOfStock = state.produtos.filter(p => p.estoque === 0);
    if (outOfStock.length > 0) {
        alertsHTML += `
            <div class="alert-item danger">
                <div class="alert-icon">
                    <i class="fas fa-box"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">Produtos sem Estoque</div>
                    <div class="alert-description">
                        ${outOfStock.length} produto${outOfStock.length !== 1 ? 's' : ''} indisponível no cardápio
                    </div>
                </div>
            </div>
        `;
    }
    
    // Verificar pedidos pendentes
    const pendingOrders = onlineMenuState.orders.filter(o => o.status === 'pending');
    if (pendingOrders.length > 0) {
        alertsHTML += `
            <div class="alert-item warning">
                <div class="alert-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">Pedidos Pendentes</div>
                    <div class="alert-description">
                        ${pendingOrders.length} pedido${pendingOrders.length !== 1 ? 's' : ''} aguardando confirmação
                    </div>
                </div>
            </div>
        `;
    }
    
    // Verificar cardápio inativo
    if (!onlineMenuState.settings.isActive) {
        alertsHTML += `
            <div class="alert-item danger">
                <div class="alert-icon">
                    <i class="fas fa-store-slash"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">Cardápio Inativo</div>
                    <div class="alert-description">
                        Seu cardápio online está desativado
                    </div>
                </div>
            </div>
        `;
    }
    
    // Alerta de avaliações novas
    const newReviews = onlineMenuState.reviews.filter(r => !r.viewed);
    if (newReviews.length > 0) {
        alertsHTML += `
            <div class="alert-item info">
                <div class="alert-icon">
                    <i class="fas fa-star"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">Novas Avaliações</div>
                    <div class="alert-description">
                        ${newReviews.length} nova${newReviews.length !== 1 ? 's' : ''} avaliação${newReviews.length !== 1 ? 'ões' : ''} para ver
                    </div>
                </div>
            </div>
        `;
    }
    
    alertsList.innerHTML = alertsHTML || '<div class="alert-item success"><div class="alert-content">Tudo funcionando perfeitamente!</div></div>';
}

function calculateBusinessMetrics() {
    // Calcular ticket médio
    const allOrders = [...onlineMenuState.orders, ...state.vendas];
    const totalRevenue = allOrders.reduce((sum, order) => sum + order.total, 0);
    const averageTicket = allOrders.length > 0 ? totalRevenue / allOrders.length : 0;
    
    document.getElementById('cardTicketMedio').textContent = formatCurrency(averageTicket);
    
    // Calcular métricas de entrega
    const deliveryOrders = onlineMenuState.orders.filter(order => order.type === 'delivery');
    const deliveredOrders = deliveryOrders.filter(order => order.status === 'delivered');
    const deliveryRate = deliveryOrders.length > 0 ? (deliveredOrders.length / deliveryOrders.length) * 100 : 0;
    
    document.getElementById('taxaEntrega').textContent = `${deliveryRate.toFixed(1)}%`;
    
    // Tempo médio de entrega (simulado)
    document.getElementById('tempoMedioEntrega').textContent = '35min';
    document.getElementById('avaliacaoEntregas').textContent = '4.8';
}

// Funções de integração
function syncWithMenu() {
    // Simular sincronização com cardápio online
    showNotification('Sincronizando com cardápio online...', 'info');
    
    setTimeout(() => {
        // Atualizar dados do cardápio (simulado)
        onlineMenuState.orders = generateSampleOrders();
        onlineMenuState.reviews = generateSampleReviews();
        
        updateDashboard();
        showNotification('Cardápio sincronizado com sucesso!', 'success');
    }, 1500);
}

function openMenuManager() {
    showNotification('Abrindo gerenciador do cardápio...', 'info');
    // Aqui você integraria com a interface do seu cardápio online
}

function viewPendingOrders() {
    showNotification('Abrindo pedidos pendentes...', 'info');
    // Navegar para a aba de pedidos
    showContent('vendas', document.querySelector('nav a[href="#"]'));
}

function viewReviews() {
    showNotification('Abrindo avaliações...', 'info');
    // Implementar visualização de avaliações
}

function viewLowStock() {
    showNotification('Abrindo controle de estoque...', 'info');
    showContent('produtos', document.querySelector('nav a[href="#"]'));
}

function viewAllOrders() {
    showNotification('Abrindo todos os pedidos...', 'info');
    showContent('vendas', document.querySelector('nav a[href="#"]'));
}

// Funções auxiliares
function getStartDate() {
    const period = parseInt(document.getElementById('periodFilter').value);
    const startDate = new Date();
    startDate.setDate(startDate.getDate() - period);
    return startDate;
}

function getStatusText(status) {
    const statusMap = {
        'pending': 'Pendente',
        'preparing': 'Preparando',
        'ready': 'Pronto',
        'delivered': 'Entregue'
    };
    return statusMap[status] || status;
}

function showNotification(message, type = 'info') {
    // Implementar sistema de notificações
    console.log(`${type.toUpperCase()}: ${message}`);
}

// Dados de exemplo para demonstração
function generateSampleOrders() {
    return [
        {
            id: 1001,
            customer: { name: 'João Silva', phone: '(11) 99999-9999' },
            items: [
                { productId: 1, name: 'Hambúrguer Artesanal', quantity: 2, price: 25.00 },
                { productId: 2, name: 'Batata Frita', quantity: 1, price: 12.00 }
            ],
            total: 62.00,
            type: 'delivery',
            status: 'pending',
            date: new Date().toISOString()
        },
        {
            id: 1002,
            customer: { name: 'Maria Santos', phone: '(11) 98888-8888' },
            items: [
                { productId: 3, name: 'Refrigerante', quantity: 1, price: 8.00 }
            ],
            total: 8.00,
            type: 'pickup',
            status: 'preparing',
            date: new Date(Date.now() - 30 * 60 * 1000).toISOString()
        }
    ];
}

function generateSampleReviews() {
    return [
        { id: 1, customer: 'Carlos Oliveira', rating: 5, comment: 'Excelente!', viewed: false },
        { id: 2, customer: 'Ana Costa', rating: 4, comment: 'Muito bom', viewed: true }
    ];
}

// Inicializar dados de exemplo
onlineMenuState.orders = generateSampleOrders();
onlineMenuState.reviews = generateSampleReviews();

// Inicializar dashboard integrado
function initializeIntegratedDashboard() {
    updateDashboard();
}

// Adicionar na função showContent existente:
// if (id === 'dashboard') { initializeIntegratedDashboard(); }
</script>
